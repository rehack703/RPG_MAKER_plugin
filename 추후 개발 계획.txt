# 추후 개발 계획 (v2)

## 1. 목표
'AI Tales' 앱의 핵심 기능인 "AI가 실시간으로 생성하는 예측 불가능한 이야기와 상호작용"을 RPG Maker 프로젝트에 구현한다. 특히, **목소리 크기**를 핵심 게임 메카닉으로 도입하여 몰입감을 극대화한다.

## 2. 핵심 기능 개발 및 리팩토링

### 2.1. `AudioInputManager.js` 개발 (기존 `SpeechToText.js` 리팩토링)
- **역할:** 모든 오디오 입력(음성 인식, 목소리 크기 측정)을 총괄.
- **주요 기능:**
  - **실시간 대화 모드:** 키(예: V)를 눌러 실시간 음성 감지 모드를 켜고 끄는 토글 기능.
  - **음성-텍스트 변환:** '연속 인식 모드'와 '말 끝 감지(`onspeechend`)'를 사용하여, 사용자가 말을 멈추면 해당 문장을 텍스트로 자동 변환.
  - **실시간 목소리 크기 측정:** `Web Audio API`를 사용하여 사용자가 말하는 동안의 목소리 크기(진폭)를 실시간으로 측정.
  - **데이터 종합:** 말이 끝나면, `{ text: "인식된 텍스트", volume: 85 }` 와 같이 텍스트와 목소리 크기를 하나의 데이터로 묶어 `AIManager`에 전달.

### 2.2. `AIManager.js` 도입 (기존 `Gemini_API_Plugin.js` 리팩토링)
- **역할:** 모든 AI 관련 API(텍스트 생성, 음성 변환 등) 통신을 중앙에서 관리하는 허브.
- **주요 기능:**
  - **API 호출 통합:** `AudioInputManager`로부터 받은 요청을 처리하고, 적절한 AI 서비스(Groq, Gemini 등)를 호출.
  - **보안 강화:** 모든 API 키를 `js/config.js` 파일에서 통합 관리.
  - **상호작용 로직 처리:** `AudioInputManager`로부터 `{ text, volume }` 데이터를 받아, `volume` 값에 따라 '대화 범위'를 계산.

### 2.3. `DynamicNPC_Plugin.js` 개발 (동적 NPC 관리)
- **역할:** NPC의 동적인 대화, 기억, 관계 시스템을 관리.
- **주요 기능:**
  - **범위 기반 반응:** `AIManager`가 계산한 '대화 범위' 안에 있는 경우에만 플레이어의 말에 반응.
  - **AI 대화 생성:** 플레이어의 말에 맞춰 NPC의 성격, 기억, 상황을 고려한 동적 대화 생성.
  - **기억 및 관계 시스템:** 플레이어와의 상호작용을 기억하고 호감도 등을 관리.

### 2.4. `DynamicWorld_Plugin.js` 개발 (동적 월드 생성)
- **역할:** AI를 통해 퀘스트, 돌발 이벤트, 장소 묘사 등을 동적으로 생성. (2순위 개발)

### 2.5. `Visualizer_Plugin.js` (AI 이미지 시각화)
- **역할:** 게임 속 상황을 AI 이미지로 생성하여 표시. (후순위 개발)

## 3. 개발 순서 제안
1. **`SpeechToText.js`를 `AudioInputManager.js`로 리팩토링:** 목소리 크기 측정 기능 추가 및 실시간 모드 로직 구현.
2. **`Gemini_API_Plugin.js`를 `AIManager.js`로 리팩토링:** `volume` 기반 대화 범위 계산 로직 추가.
3. **`DynamicNPC_Plugin.js` 개발:** 범위 기반 반응 및 기본 대화 생성 기능 구현.
4. `DynamicWorld_Plugin.js` 개발.
5. `Visualizer_Plugin.js` 개발.